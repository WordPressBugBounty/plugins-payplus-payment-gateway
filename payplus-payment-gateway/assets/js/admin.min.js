let price=document.querySelectorAll(".price"),fullAmount=document.querySelectorAll(".payplus-full-amount"),table_payment=null,allSum=document.getElementById("all-sum");function payplus_empty_field(){var t=document.querySelectorAll("#all-payment-invoice input,#all-payment-invoice select"),a=document.querySelectorAll(".create_at"),p=payplus_get_date();for(let e=0;e<t.length;e++){var n=t[e].classList;"method_payment"!=n[2]&&"number_of_payments"!=n[2]&&(t[e].value="")}for(let e=0;e<a.length;e++)a[e].value=p}function payplus_set_collection(t){var a=[];for(let e=0;e<t.length;e++){var p=t[e].classList;document.querySelector("."+p[2])&&(a[p[2]]=t[e].value)}return a}function payplus_set_max_total(a=!0){var e=document.getElementById("post_ID"),p=document.querySelector(".select-type-invoice");if(e&&price&&allSum){e=document.getElementById("payplus_sum_payment");let t=payplus_get_sum_payments().toFixed(2);t=(t=allSum.value-t)?Number(t.toFixed(2)):0;for(let e=0;e<price.length;e++)price[e].setAttribute("max",t),t||price[e].setAttribute("min",t),a&&(price[e].value=t);for(let e=0;e<fullAmount.length;e++)fullAmount[e].setAttribute("data-sum",t);"inv_receipt"!=p.value&&"inv_tax_receipt"!=p.value||(document.getElementById("all-payment-invoice").style.display="block",e.style.display="block")}}function payplus_get_sum_payments(a=-1){var e=document.getElementById("post_ID");let t=0;return e&&(e=JSON.parse(localStorage.getItem("payplus_payment_"+e.value)))&&(t=-1!=a?e.reduce((e,t)=>t.row_id!=a?e+parseFloat(t.price):e,0):e.reduce((e,t)=>e+parseFloat(t.price),0)),Math.round(100*t)/100}function payplus_set_payments(e){var t=parseFloat(number_of_payments.value);(e=document.querySelector("."+e+".price").value)&&t&&(t=(e/t).toFixed(2),first_payment.value=t,subsequent_payments.value=(e-t).toFixed(2))}function payplus_get_date(){var e=new Date;let t=e.getDate(),a=e.getMonth()+1;e=e.getFullYear(),a<10&&(a="0"+a),t<10&&(t="0"+t),e=`${e}-${a}-`+t;return e}function payplus_print_payments(a,e){let t="",p=["bank_number","account_number","branch_number","check_number","four_digits","brand_name","transaction_type","number_of_payments","first_payment","subsequent_payments","payment_app","transaction_id","payer_account","notes"],n=(table_payment=jQuery(".payplus-table-payment tbody"),Object.assign({},a));Object.keys(a).forEach(function(t,e){if(p.includes(t)&&null!=a[t]&&""!=a[t]){let e=t.charAt(0).toUpperCase()+t.slice(1);e=e.replace("_"," "),"first_payment"!=t&&"subsequent_payments"!=t&&"number_of_payments"!=t||"payments"==a.transaction_type||"credit"==a.transaction_type?n[t]="<p><b> "+e+"</b> : "+a[t]+"</p>":delete n[t]}else delete n[t]}),payplus_obj_isObjectEmpty(n)&&(t=payplus_obj_ToString(n));var s=a&&a.price?Number(parseFloat(a.price).toFixed(2)):0,o=`${(o=a.create_at.split("-"))[2]}-${o[1]}-`+o[0],s=`<tr class="row-payment-${a.row_id}">
        <td>
        <a class="link-action" data-id=${a.row_id} onclick="payplus_delete_element(${a.row_id})">${payplus_script_payment.btn_delete}</a>
        <a class="link-action" data-id=${a.row_id} onclick="payplus_edit_element(${a.row_id})">${payplus_script_payment.btn_edit}</a>
        </td>
         <td><span class="woocommerce-Price-amount amount"><bdi><span class="woocommerce-Price-currencySymbol">
                    ${payplus_script_payment.currency_symbol}</span>${s}</bdi></span>
                 </td>
                    <td>${t}</td>
                  <td>${a.method_payment.replace("-"," ")}</td>
                 <td>${o}</td>
                  
            </tr>`;""==table_payment.html()?table_payment.html(s):table_payment.append(s)}function payplus_print_payments_all(){var e=document.getElementById("post_ID"),t=(table_payment=jQuery(".payplus-table-payment tbody"),jQuery("#payplus_sum_payment"));if(e&&table_payment){var a=JSON.parse(localStorage.getItem("payplus_payment_"+e.value));if(a)if(table_payment.html(""),a.length){e=`<strong>${payplus_script_payment.payplus_sum} : ${payplus_script_payment.currency_symbol}${payplus_get_sum_payments()}  </strong>`;for(let e=0;e<a.length;e++)payplus_print_payments(a[e],e);t.html(e),t.addClass("payplus_sum_payment")}else t.html("")}}function payplus_delete_element(t,a=!1){let e=!0;if(e=a?e:confirm(payplus_script_payment.delete_confim)){document.querySelectorAll(".select-type-payment").forEach(function(e,t){e.style.display="none"}),jQuery(".type-payment").removeClass("hover");var p=document.getElementById("post_ID");if(p){let e=JSON.parse(localStorage.getItem("payplus_payment_"+p.value));(e=e.filter(e=>e.row_id!=t)).length||(e=[]),localStorage.setItem("payplus_payment_"+p.value,JSON.stringify(e)),payplus_print_payments_all(),payplus_set_max_total(!a)}}}function payplus_edit_element(e){var t=document.getElementById("post_ID");if(t){t=JSON.parse(localStorage.getItem("payplus_payment_"+t.value));if(document.querySelectorAll(".select-type-payment").forEach(function(e,t){e.style.display="none"}),t[e]){var a=t[e],p=a.method_payment+"-payment-payplus",t=document.querySelector(".select-type-payment."+a.method_payment),e=document.getElementsByClassName(p),n=Array.prototype.filter.call(e,e=>"INPUT"===e.nodeName||"SELECT"===e.nodeName);for(let e=0;e<n.length;e++){var s=n[e].classList;if(document.querySelector("."+p+"."+s[2]).value=a[s[2]],"price"==s[2]){let t=allSum.value-payplus_get_sum_payments(a.row_id);t=t.toFixed(2),document.querySelector("."+p+"."+s[2]).setAttribute("max",t);for(let e=0;e<price.length;e++)price[e].value=t;document.querySelector("."+p+"."+s[2]).value=a.price;for(let e=0;e<fullAmount.length;e++)fullAmount[e].setAttribute("data-sum",t)}}"payments"==a.transaction_type||"credit"==a.transaction_type?document.querySelector(".payplus_payment").style.display="flex":document.querySelector(".payplus_payment").style.display="none",jQuery(".type-payment").removeClass("hover"),jQuery("."+a.method_payment+".type-payment").addClass("hover"),t.style.display="block",document.getElementById("all-payment-invoice").style.display="block"}}}function payplus_get_storage(e){return JSON.parse(localStorage.getItem("payplus_payment_"+e))}function payplus_obj_ToString(e){var t,a="";for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&(a+=e[t]);return a}function payplus_obj_isObjectEmpty(e){return 0<Object.keys(e).length}jQuery(function(s){let e=s(".global_shipping"),t=s(".shipping_woo"),a=s(".global_shipping_tax"),p=s(".global_shipping_tax_rate"),n=s(".enable_google_pay"),o=s(".enable_apple_pay"),l=s(".apple_pay_identifier"),r=s(".google_pay_page_uid"),i=s(".shipping_woo_js"),c=s(".enable_product");var u=s("#woocommerce_payplus-payment-gateway_settings\\[check_amount_authorization\\]");let y=s("#woocommerce_payplus-payment-gateway_block_ip_transactions"),d=s("#woocommerce_payplus-payment-gateway_block_ip_transactions_hour");var _=s("#woocommerce_payplus-payment-gateway_settings\\[change_vat_in_eilat\\]");let m=s("#woocommerce_payplus-payment-gateway_settings\\[keywords_eilat\\]");var h=s("#woocommerce_payplus-payment-gateway_settings\\[paying_vat_all_order\\]");let g=s("#woocommerce_payplus-payment-gateway_iframe_height"),v=s("#woocommerce_payplus-payment-gateway_iframe_auto_height");var f=s(".payplus-delete-error"),w=s(".create-invoice-manual");let b=s(".invoice-manual-list"),k=s(".list-hidden"),x=s("#first_payment"),S=s("#subsequent_payments"),q=s("#number_of_payments");var I=document.getElementById("post_ID");if(I&&(payplus_print_payments_all(),payplus_set_max_total()),w&&"no"===w.val()&&b.parents("tr").fadeOut(),w.change(function(){"yes"===s(this).val()?b.closest("tr").fadeIn():b.closest("tr").fadeOut()}),k.length&&(k=k.val().split(",")).length){for(let t=0;t<k.length;t++){let e=k[t];s.each(s(".invoice-manual-list").children("option"),function(){""!=e&&e==s(this).val()&&s(this).prop("selected",!0)})}s(".invoice-manual-list").children("option:first").prop("selected",!1)}function O(){v.prop("checked")?g.closest("tr").hide():g.closest("tr").show()}function j(){var e=s('select[name="woocommerce_payplus-payment-gateway_display_mode"]').val(),t=s(".iframe-width-field").closest("tr");"popupIframe"===e?t.show():t.hide()}["payplus-payment-gateway-bit","payplus-payment-gateway-googlepay","payplus-payment-gateway-applepay","payplus-payment-gateway-multipass","payplus-payment-gateway-paypal","payplus-payment-gateway-tavzahav","payplus-payment-gateway-valuecard","payplus-payment-gateway-finitione","payplus-payment-gateway-hostedfields"].forEach(function(e){s('tr[data-gateway_id="'+e+'"] .payment-method-features-info').remove()}),f.click(function(e){e.preventDefault(),s(this).closest("tr").remove()}),s(document).ready(function(){O()}),v.change(function(){O()}),s(document).ready(function(){j()}),s('select[name="woocommerce_payplus-payment-gateway_display_mode"]').on("change",j),_.prop("checked")||m.closest("tr").fadeOut(),s(".invoice-manual-list").change(function(){var e=s(this).val();s(".list-hidden").val(e)}),_.change(function(){s(this).prop("checked")?m.closest("tr").fadeIn():m.closest("tr").fadeOut()}),y.prop("checked")||d.closest("tr").fadeOut(),y.change(function(){y.prop("checked")?d.closest("tr").fadeIn():d.closest("tr").fadeOut()});let E="",A="";if("undefined"!=typeof payplus_script_payment){I=payplus_script_payment.wc_tax_enabled;let e=payplus_script_payment.currentLanguage.substring(0,2);E=payplus_script_payment.enableExpressOnProductPageMessage,A=payplus_script_payment.displayOnProductPage;w="he"===(e="en"!==e&&"he"!==e?"en":e)?"שימו לב: שיעורי המס והחישובים מופעלים באתר זה - חלק ההגדרות הרשומות מעלה לא יהיו ברות השפעה.":"Attention: The tax rates and calculations are enabled on this site - Some of fields above will not take affect.",f=(I&&h.closest("table").append('<p style="color: red;">'+w+"</p>"),payplus_script_payment.transactionType);2!=f&&u.closest("tr").fadeOut()}o&&!1===o.prop("checked")&&l.parents("tr").fadeOut(),n&&!1===n.prop("checked")&&r.parents("tr").fadeOut();let B=()=>{var e=c.closest("td").prev().text()+"<br><span style='color: red;'>"+E+"</span>";c.closest("td").prev().html(e)};function D(){var e=s("select#woocommerce_payplus-payment-gateway_display_mode").val();"redirect"==e?(s("input#woocommerce_payplus-payment-gateway_iframe_height").closest("tr").hide(),s("select#woocommerce_payplus-payment-gateway_display_mode").siblings("p.description").show()):"iframe"===e?(s("select#woocommerce_payplus-payment-gateway_display_mode").siblings("p.description").show(),s("input#woocommerce_payplus-payment-gateway_iframe_height").closest("tr").show()):(s("input#woocommerce_payplus-payment-gateway_iframe_height").closest("tr").show(),s("select#woocommerce_payplus-payment-gateway_display_mode").siblings("p.description").hide())}function N(){"2"==s("select#woocommerce_payplus-payment-gateway_settings\\[paying_vat\\]").val()?(s("input#woocommerce_payplus-payment-gateway_settings\\[paying_vat_iso_code\\]").closest("tr").show(),s("input#woocommerce_payplus-payment-gateway_settings\\[foreign_invoices_lang\\]").closest("tr").show()):(s("input#woocommerce_payplus-payment-gateway_settings\\[paying_vat_iso_code\\]").closest("tr").hide(),s("input#woocommerce_payplus-payment-gateway_settings\\[foreign_invoices_lang\\]").closest("tr").hide())}function C(){"1"==s("select#woocommerce_payplus-payment-gateway_settings\\[initial_invoice\\]").val()?(s("select#woocommerce_payplus-payment-gateway_settings\\[paying_vat\\]").closest("tr").show(),s("input#woocommerce_payplus-payment-gateway_settings\\[paying_vat_iso_code\\]").closest("tr").show(),s("input#woocommerce_payplus-payment-gateway_settings\\[foreign_invoices_lang\\]").closest("tr").show()):(s("select#woocommerce_payplus-payment-gateway_settings\\[paying_vat\\]").closest("tr").hide(),s("input#woocommerce_payplus-payment-gateway_settings\\[paying_vat_iso_code\\]").closest("tr").hide(),s("input#woocommerce_payplus-payment-gateway_settings\\[foreign_invoices_lang\\]").closest("tr").hide())}c.prop("checked")&&i.prop("checked")&&B(),c.change(function(){c.prop("checked")&&i.prop("checked")?B():c.closest("td").prev().html(A)}),i.change(function(){c.prop("checked")&&!i.prop("checked")?c.closest("td").prev().html(A):c.prop("checked")&&i.prop("checked")&&B()}),t.prop("checked")?(e.closest("tr").fadeOut(),a.closest("tr").fadeOut(),p.closest("tr").fadeOut()):(n.prop("checked")||o.prop("checked"))&&(e.attr("required","required"),a.attr("required","required"),p.attr("required","required")),t&&!t.prop("checked")&&e&&!e.val()&&e.val(0),t.change(function(){s(this).prop("checked")?(e.closest("tr").fadeOut(),a.closest("tr").fadeOut(),p.closest("tr").fadeOut(),e.removeAttr("required"),a.removeAttr("required"),p.removeAttr("required")):(e.closest("tr").fadeIn(),a.closest("tr").fadeIn(),p.closest("tr").fadeIn(),(n.prop("checked")||o.prop("checked"))&&(e.attr("required","required"),a.attr("required","required"),p.attr("required","required"),"none"==a.val())&&p.closest("tr").fadeOut())}),a.change(function(){"none"==s(this).val()?(p.find("option[value=0]").val("0"),p.parents("tr").fadeOut()):(p.find("option[value=0]").val(""),p.attr("required","required"),p.parents("tr").fadeIn())}),n.change(function(e){e.preventDefault();let t=s(this);e=t.prop("checked");let a=n.parents("fieldset");s(".error-express-checkout").html(""),e&&(a.find(".loading-express").fadeIn(),s.ajax({type:"post",dataType:"json",url:payplus_script_admin.ajax_url,data:{action:"payplus-express-checkout-initialized",method:"google-pay",_ajax_nonce:payplus_script_payment.frontNonce},success:function(e){a.find(".loading-express").fadeOut(),e.status?(r.parents("tr").fadeIn(),r.val(payplus_script_admin.mainPageUid)):(a.find(".error-express-checkout").html("<b>payplus error : </b>"+e.response_initialized.results.description),t.prop("checked",!1))}}))}),o.change(function(){var e=s(this).prop("checked");let t=o.parents("fieldset"),a=s(this);s(".error-express-checkout").html(""),e?(t.find(".loading-express").fadeIn(),s.ajax({type:"post",dataType:"json",url:payplus_script_admin.ajax_url,data:{action:"payplus-express-checkout-initialized",method:"apple-pay",_ajax_nonce:payplus_script_payment.frontNonce},success:function(e){t.find(".loading-express").fadeOut(),e.status?(l.parents("tr").fadeIn(),l.val(e.response_initialized.apple_pay_identifier)):(e=e.response_initialized.results.description.description||e.response_initialized.results.description,t.find(".error-express-checkout").html("<b> payplus error : </b>"+e),a.prop("checked",!1))}})):l.parents("tr").fadeOut()}),s("#woocommerce_payplus-payment-gateway_transaction_type").change(function(){2==s(this).val()?s("#woocommerce_payplus-payment-gateway_check_amount_authorization").prop("disabled",!1):s("#woocommerce_payplus-payment-gateway_check_amount_authorization").prop("disabled",!0)}),s("#chargeByItems").is(":checked")?s("#totalorder").show():s("#totalorder").hide(),s("div#payplus-options").length&&(D(),N(),C(),s("#payplus_invoice_option\\[payplus_invoice_enable\\]").prop("checked")&&(["#payplus_invoice_option\\[payplus_invoice_type_document_refund\\]","#payplus_invoice_option\\[payplus_invoice_type_document\\]","#payplus_invoice_option\\[payplus_invoice_status_order\\]"].forEach(function(e){""===s(e).val()&&(s(e).css("border-color","red"),s(e).parent().parent().children("th").css("color","red"))}),s("#payplus_invoice_option\\[display_only_invoice_docs\\]").closest("tr").hide()),s("#payplus_invoice_option\\[payplus_invoice_enable\\]").change(function(){s(this).is(":checked")?s("#payplus_invoice_option\\[display_only_invoice_docs\\]").closest("tr").hide():s("#payplus_invoice_option\\[display_only_invoice_docs\\]").closest("tr").show()}),s(document).on("change","select#woocommerce_payplus-payment-gateway_display_mode",function(){D()}),s(document).on("change","select#woocommerce_payplus-payment-gateway_settings\\[paying_vat\\]",function(){N()}),s(document).on("change","select#woocommerce_payplus-payment-gateway_settings\\[initial_invoice\\]",function(){C(),N()})),s(document).on("change","#number_of_payments",function(e){payplus_set_payments(e.target.classList[0])}),s(document).on("click",".type-payment",function(e){e.preventDefault();e=this.getAttribute("data-type");let a=null;document.querySelectorAll(".select-type-payment").forEach(function(e,t){"block"==e.style.display&&(a=document.querySelector(".select-type-payment."+e.classList[1]+" .row_id").value),e.style.display="none"}),s(".type-payment").removeClass("hover"),s(this).addClass("hover"),document.querySelector(".select-type-payment."+e).style.display="block",document.querySelector(".select-type-payment."+e+" .row_id").value=a}),s(document).on("change",".transaction_type",function(e){e.preventDefault();var t=s(this).val();"payments"==t||"credit"==t?(document.querySelector(".payplus_payment").style.display="flex",payplus_set_payments(e.target.classList[0])):(S.value=0,q.value=2,x.value=0,document.querySelector(".payplus_payment").style.display="none")}),s(document).on("click",".payplus-full-amount",function(e){e.preventDefault();var t=e.target.getAttribute("data-sum"),e=e.target.classList.item(1);document.querySelector("."+e+".price").value=t,"flex"==document.querySelector(".payplus_payment").style.display&&payplus_set_payments(e)}),s(document).on("input",".price",function(e){e.preventDefault();var t=e.target.value,a=e.target.getAttribute("max"),p=e.target.classList;t?((parseFloat(t)<0||parseFloat(a)<parseFloat(t))&&(e.target.value=0==t?0:a),"flex"==document.querySelector(".payplus_payment").style.display?payplus_set_payments(p[0]):(S.val(0),q.val(2),x.val(0),document.querySelector(".payplus_payment").style.display="none")):(S.val(0),q.val(2),x.val(0))}),s(document).on("click",".payplus-payment-button",function(e){e.preventDefault();e=e.target.id;this.classList.add("button-loading");let t=null,a=0;var p=s("#post_ID").val();let n=JSON.parse(localStorage.getItem("payplus_payment_"+p));e=document.getElementsByClassName(e),e=Array.prototype.filter.call(e,e=>"INPUT"===e.nodeName||"SELECT"===e.nodeName);(t=payplus_set_collection(e)).row_id&&document.querySelector(".row-payment-"+t.row_id).remove(),t.order_id=p,0<(t=Object.assign({},t)).price&&""!=t.price?(t.row_id?n[t.row_id]=t:(n?a=n.length:n=[],t.row_id=a,n[a]=t),localStorage.setItem("payplus_payment_"+p,JSON.stringify(n)),payplus_empty_field(),payplus_print_payments_all(),payplus_set_max_total(),document.querySelectorAll(".select-type-payment").forEach(function(e,t){e.style.display="none"}),jQuery(".type-payment").removeClass("hover")):alert(payplus_script_payment.error_price),this.classList.remove("button-loading")}),s(document).on("change",".select-type-invoice",function(e){e.preventDefault();e=s(this).val();"inv_receipt"==e||"inv_tax_receipt"==e?(document.getElementById("all-payment-invoice").style.display="block",document.getElementById("payplus-table-payment").style.display="table",document.getElementById("payplus_sum_payment").style.display="block"):(document.getElementById("all-payment-invoice").style.display="none",document.getElementById("payplus-table-payment").style.display="none",document.getElementById("payplus_sum_payment").style.display="none")}),s(document).on("click","#payplus-create-invoice",function(e){e.preventDefault();let t=s(this).attr("data-id");var a,e=s("#select-type-invoice-"+t).val();let p=this;return""==e?alert(payplus_script_payment.error_payment_select_doc):!allSum||"inv_receipt"!=e&&"inv_tax_receipt"!=e||payplus_get_sum_payments()==allSum.value?(s(p).addClass("button-loading"),s(p).hide(),s(p).next(".payplus_loader_gpp").fadeIn(),a=payplus_get_storage(t),s.ajax({type:"post",dataType:"json",url:payplus_script_admin.ajax_url,data:{action:"payplus-create-invoice",order_id:t,payments:a,typeDocument:e,_ajax_nonce:payplus_script_payment.create_invoice_nonce},success:function(e){!1===e.success&&(alert(e.data),location.reload()),s(p).removeClass("button-loading"),s("#payment-payplus-dashboard,.payplus_loader").fadeOut(),e.status&&(localStorage.removeItem("payplus_payment_"+t),location.href=e.urlredirect)},error:function(e,t,a){alert("Error: Either you do not have permission or unknown error.")}})):alert(payplus_script_payment.error_payment_sum),!1}),s(document).ready(function(){s(".toggle-button").on("click",function(e){e.preventDefault();e=s(this).siblings(".hidden-buttons");e.toggleClass("invoicePlusButtonHidden invoicePlusButtonVisible"),e.hasClass("invoicePlusButtonVisible"),s(this).toggleClass("flip")})}),s(document).on("click","#payplus-create-invoice-refund",function(e){e.preventDefault();var t,e=s(this).attr("data-id"),a=s("#select-type-invoice-refund-"+e).val(),p=s("#amount-refund-"+e).val();let n=this;return""==a?alert("No document type selected"):((t=new FormData).append("action","payplus-create-invoice-refund"),t.append("order_id",e),t.append("amount",p),t.append("type_document",a),t.append("_ajax_nonce",payplus_script_payment.create_invoice_refund_nonce),s(n).addClass("button-loading"),fetch(payplus_script_admin.ajax_url,{method:"post",headers:{Accept:"application/json"},body:t}).then(e=>e.json()).then(e=>{s(n).removeClass("button-loading"),e.status&&(location.href=e.urlredirect)})),!1})}),jQuery(document).ready(function(r){r("#run-payplus-invoice-runner").on("click",function(){var e=r(this),l=r("#payplus-runner-result"),t=r("#payplus-runner-loading"),a=e.data("nonce");a?(e.prop("disabled",!0),t.show(),l.html(""),r.ajax({url:ajaxurl,type:"POST",data:{action:"run_payplus_invoice_runner",nonce:a},timeout:12e4,success:function(e){try{var t=JSON.parse(e);if(t.success){var a='<div class="notice notice-success"><p>'+t.message+"</p></div>";if(t.data){var p=t.data;if(a=(a=(a=(a=(a=(a=(a=(a=(a=(a=(a=(a=(a+='<div class="payplus-results-detail" style="margin-top: 20px;">')+("<h3>"+payplus_admin_vars.detailed_results+"</h3>"))+'<table class="widefat fixed striped">'+"<thead><tr>")+('<th style="width: 20%;">'+payplus_admin_vars.metric+"</th>"))+("<th>"+payplus_admin_vars.value+"</th>")+"</tr></thead><tbody>")+("<tr><td>"+payplus_admin_vars.started_at+"</td><td>"+p.started_at+"</td></tr>"))+("<tr><td>"+payplus_admin_vars.completed_at+"</td><td>"+p.completed_at+"</td></tr>"))+("<tr><td>"+payplus_admin_vars.total_orders_checked+"</td><td>"+p.total_orders_checked+"</td></tr>"))+("<tr><td>"+payplus_admin_vars.payplus_orders_found+"</td><td>"+p.payplus_orders_found+"</td></tr>"))+("<tr><td>"+payplus_admin_vars.invoices_created+'</td><td><strong style="color: green;">'+p.invoices_created+"</strong></td></tr>"))+("<tr><td>"+payplus_admin_vars.invoices_already_exist+"</td><td>"+p.invoices_already_exist+"</td></tr>"))+("<tr><td>"+payplus_admin_vars.skipped_non_payplus+"</td><td>"+p.skipped_non_payplus+"</td></tr>"))+("<tr><td>"+payplus_admin_vars.errors+"</td><td>"+(p.errors?p.errors.length:0)+"</td></tr>")+"</tbody></table>",p.errors&&0<p.errors.length){for(var a=a+('<h4 style="color: red; margin-top: 20px;">'+payplus_admin_vars.errors_encountered+"</h4>")+'<ul style="color: red;">',n=0;n<p.errors.length;n++)a+="<li>"+r("<div>").text(p.errors[n]).html()+"</li>";a+="</ul>"}if(p.processed_orders&&0<p.processed_orders.length){a=(a=(a=(a=(a=(a+='<h4 style="margin-top: 20px;">'+payplus_admin_vars.order_processing_details+"</h4>")+'<table class="widefat fixed striped">'+"<thead><tr>")+("<th>"+payplus_admin_vars.order_id+"</th>"))+("<th>"+payplus_admin_vars.payment_method+"</th>"))+("<th>"+payplus_admin_vars.status+"</th>"))+("<th>"+payplus_admin_vars.reason+"</th>")+"</tr></thead><tbody>";for(n=0;n<Math.min(p.processed_orders.length,50);n++){var s=p.processed_orders[n],o="";"invoice_created"===s.status?o="color: green; font-weight: bold;":"error"===s.status&&(o="color: red; font-weight: bold;"),a=(a=(a=(a=(a+="<tr>")+('<td><a href="'+payplus_admin_vars.admin_url+"post.php?action=edit&post="+s.order_id+'" target="_blank">#'+s.order_id+"</a></td>"))+("<td>"+r("<div>").text(s.payment_method).html()+"</td>"))+('<td style="'+o+'">'+r("<div>").text(s.status).html()+"</td>"))+("<td>"+r("<div>").text(s.reason).html()+"</td>")+"</tr>"}50<p.processed_orders.length&&(a+='<tr><td colspan="4"><em>'+payplus_admin_vars.more_orders_message+"</em></td></tr>"),a+="</tbody></table>"}a+="</div>"}l.html(a)}else l.html('<div class="notice notice-error"><p>'+r("<div>").text(t.message).html()+"</p></div>")}catch(e){l.html('<div class="notice notice-error"><p>'+payplus_admin_vars.error_parsing_response+"</p></div>")}},error:function(e,t,a){var p=payplus_admin_vars.runner_error;"timeout"===t?p=payplus_admin_vars.request_timeout:403===e.status?p=payplus_admin_vars.security_verification_failed:405===e.status&&(p=payplus_admin_vars.invalid_request_method),l.html('<div class="notice notice-error"><p>'+p+"</p></div>")},complete:function(){e.prop("disabled",!1),t.hide()}})):l.html('<div class="notice notice-error"><p>'+payplus_admin_vars.security_token_missing+"</p></div>")})});