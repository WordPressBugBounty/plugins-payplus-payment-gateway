jQuery(function(e){if("undefined"==typeof wc_checkout_params)return!1;let t=payplus_script_checkout.hostedFieldsIsMain,o=payplus_script_checkout.iframeAutoHeight,a="payment_method_payplus-payment-gateway-hostedfields";var i=jQuery("body > div.container.hostedFields");let n=!0;e.blockUI.defaults.overlayCSS.cursor="default";let c=Object.keys(payplus_script_checkout.hasSavedTokens);function r(){if(!(jQuery(".pp_iframe").length>0||jQuery(".pp_iframe_h").length>0||jQuery("#pp_iframe").length>0)){const e=jQuery(".payment_method_payplus-payment-gateway-hostedfields");if(e.length>0){e.hide(),jQuery(".payment_box.payment_method_payplus-payment-gateway-hostedfields").hide();const t=jQuery("input#payment_method_payplus-payment-gateway-hostedfields");t.is(":checked")&&jQuery("input#payment_method_payplus-payment-gateway").prop("checked",!0).trigger("change"),t.prop("disabled",!0)}}}r(),setTimeout(r,100),setTimeout(r,500);var s=!1,p=!1;function d(e){if(!p)return payplus_script_checkout.popupTvEffect&&"popupIframe"===payplus_script_checkout.viewMode&&"undefined"!=typeof alertify&&jQuery(".alertify").length>0?(p=!0,s=!0,jQuery(".alertify").addClass("tv-closing"),void setTimeout(function(){window.location.href=e},1050)):void(window.location.href=e)}function u(e){if(e&&e.order_id&&e.order_received_url){var t=e.order_received_url,o="";try{var a=new URL(t,window.location.origin);o=a.searchParams.get("key")||""}catch(e){return}if(o){var i=0;c();var n=setInterval(function(){s?clearInterval(n):c()},1500)}}function c(){s||++i>200||jQuery.ajax({url:payplus_script_checkout.ajax_url,type:"POST",data:{action:"payplus_check_order_redirect",_ajax_nonce:payplus_script_checkout.frontNonce,order_id:e.order_id,order_key:o},dataType:"json",success:function(e){if(!s&&e&&e.success&&e.data&&e.data.status){var o=e.data.status;"processing"!==o&&"completed"!==o&&"wc-processing"!==o&&"wc-completed"!==o||(s=!0,d(e.data.redirect_url||t))}}})}}window.addEventListener("message",function(e){if(e.data&&"payplus_redirect"===e.data.type&&e.data.url)try{new URL(e.data.url,window.location.origin).origin===window.location.origin&&(s=!0,d(e.data.url))}catch(e){}});var l={updateTimer:!1,dirtyInput:!1,selectedPaymentMethod:!1,xhr:!1,$order_review:e("#order_review"),$checkout_form:e("form.checkout"),init:function(){e(document.body).on("update_checkout",this.update_checkout),e(document.body).on("init_checkout",this.init_checkout),this.$checkout_form.on("click",'input[name="payment_method"]',this.payment_method_selected),e(document.body).hasClass("woocommerce-order-pay")&&(this.$order_review.on("click",'input[name="payment_method"]',this.payment_method_selected),this.$order_review.on("submit",this.submitOrder),this.$order_review.attr("novalidate","novalidate")),this.$checkout_form.attr("novalidate","novalidate"),this.$checkout_form.on("submit",this.submit),this.$checkout_form.on("input validate change",".input-text, select, input:checkbox",this.validate_field),this.$checkout_form.on("update",this.trigger_update_checkout),this.$checkout_form.on("change",'select.shipping_method, input[name^="shipping_method"], #ship-to-different-address input, .update_totals_on_change select, .update_totals_on_change input[type="radio"], .update_totals_on_change input[type="checkbox"]',this.trigger_update_checkout),this.$checkout_form.on("change",".address-field select",this.input_changed),this.$checkout_form.on("change",".address-field input.input-text, .update_totals_on_change input.input-text",this.maybe_input_changed),this.$checkout_form.on("keydown",".address-field input.input-text, .update_totals_on_change input.input-text",this.queue_update_checkout),this.$checkout_form.on("change","#ship-to-different-address input",this.ship_to_different_address),this.$checkout_form.find("#ship-to-different-address input").trigger("change"),this.init_payment_methods(),"1"===wc_checkout_params.is_checkout&&e(document.body).trigger("init_checkout"),"yes"===wc_checkout_params.option_guest_checkout&&e("input#createaccount").on("change",this.toggle_create_account).trigger("change")},init_payment_methods:function(){var t=e(".woocommerce-checkout").find('input[name="payment_method"]');1===t.length&&t.eq(0).hide(),l.selectedPaymentMethod&&e("#"+l.selectedPaymentMethod).prop("checked",!0),0===t.filter(":checked").length&&t.eq(0).prop("checked",!0);var o=t.filter(":checked").eq(0).prop("id");t.length>1&&e('div.payment_box:not(".'+o+'")').filter(":visible").hide(),t.filter(":checked").eq(0).trigger("click")},get_payment_method:function(){return l.$checkout_form.find('input[name="payment_method"]:checked').val()},payment_method_selected:function(t){if(g(!0),t.stopPropagation(),e(".payment_methods input.input-radio").length>1){var o=e("div.payment_box."+e(this).attr("ID")),a=e(this).is(":checked");a&&!o.is(":visible")&&(e("div.payment_box").filter(":visible").fadeOut(200),a&&o.fadeIn(200))}e(this).data("order_button_text")?e("#place_order").text(e(this).data("order_button_text")):e("#place_order").text(e("#place_order").data("value"));var i=e('.woocommerce-checkout input[name="payment_method"]:checked').attr("id");i!==l.selectedPaymentMethod&&e(document.body).trigger("payment_method_selected"),l.selectedPaymentMethod=i},toggle_create_account:function(){e("div.create-account").hide(),e(this).is(":checked")&&(e("#account_password").val("").trigger("change"),e("div.create-account").slideDown())},init_checkout:function(){e(document.body).trigger("update_checkout")},maybe_input_changed:function(e){l.dirtyInput&&l.input_changed(e)},input_changed:function(e){l.dirtyInput=e.target,l.maybe_update_checkout()},queue_update_checkout:function(e){if(9===(e.keyCode||e.which||0))return!0;l.dirtyInput=this,l.reset_update_checkout_timer(),l.updateTimer=setTimeout(l.maybe_update_checkout,"1000")},trigger_update_checkout:function(){l.reset_update_checkout_timer(),l.dirtyInput=!1,e(document.body).trigger("update_checkout")},maybe_update_checkout:function(){var t=!0;if(e(l.dirtyInput).length){var o=e(l.dirtyInput).closest("div").find(".address-field.validate-required");o.length&&o.each(function(){""===e(this).find("input.input-text").val()&&(t=!1)})}t&&l.trigger_update_checkout()},ship_to_different_address:function(){e("div.shipping_address").hide(),e(this).is(":checked")&&e("div.shipping_address").slideDown()},reset_update_checkout_timer:function(){clearTimeout(l.updateTimer)},is_valid_json:function(e){try{var t=JSON.parse(e);return t&&"object"==typeof t}catch(e){return!1}},validate_field:function(t){var o=e(this),a=o.closest(".form-row"),i=!0,n=a.is(".validate-required"),c=a.is(".validate-email"),r=a.is(".validate-phone"),s="",p=t.type;"input"===p&&a.removeClass("woocommerce-invalid woocommerce-invalid-required-field woocommerce-invalid-email woocommerce-invalid-phone woocommerce-validated"),"validate"!==p&&"change"!==p||(n&&("checkbox"!==o.attr("type")||o.is(":checked")?""===o.val()&&(a.removeClass("woocommerce-validated").addClass("woocommerce-invalid woocommerce-invalid-required-field"),i=!1):(a.removeClass("woocommerce-validated").addClass("woocommerce-invalid woocommerce-invalid-required-field"),i=!1)),c&&o.val()&&((s=new RegExp(/^([a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+(\.[a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+)*|"((([ \t]*\r\n)?[ \t]+)?([\x01-\x08\x0b\x0c\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|\\[\x01-\x09\x0b\x0c\x0d-\x7f\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))*(([ \t]*\r\n)?[ \t]+)?")@(([a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.)+([a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[0-9a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.?$/i)).test(o.val())||(a.removeClass("woocommerce-validated").addClass("woocommerce-invalid woocommerce-invalid-email woocommerce-invalid-phone"),i=!1)),r&&(s=new RegExp(/[\s\#0-9_\-\+\/\(\)\.]/g),0<o.val().replace(s,"").length&&(a.removeClass("woocommerce-validated").addClass("woocommerce-invalid woocommerce-invalid-phone"),i=!1)),i&&a.removeClass("woocommerce-invalid woocommerce-invalid-required-field woocommerce-invalid-email woocommerce-invalid-phone").addClass("woocommerce-validated"))},update_checkout:function(e,t){l.reset_update_checkout_timer(),l.updateTimer=setTimeout(l.update_checkout_action,"5",t)},update_checkout_action:function(o){if(l.xhr&&l.xhr.abort(),0!==e("form.checkout").length){o=void 0!==o?o:{update_shipping_method:!0};var r=e("#billing_country").val(),s=e("#billing_state").val(),p=e(":input#billing_postcode").val(),d=e("#billing_city").val(),u=e(":input#billing_address_1").val(),m=e(":input#billing_address_2").val(),h=r,_=s,y=p,f=d,g=u,v=m,k=e(l.$checkout_form).find(".address-field.validate-required:visible"),w=!0;k.length&&k.each(function(){""===e(this).find(":input").val()&&(w=!1)}),e("#ship-to-different-address").find("input").is(":checked")&&(h=e("#shipping_country").val(),_=e("#shipping_state").val(),y=e(":input#shipping_postcode").val(),f=e("#shipping_city").val(),g=e(":input#shipping_address_1").val(),v=e(":input#shipping_address_2").val());var b={security:wc_checkout_params.update_order_review_nonce,payment_method:l.get_payment_method(),country:r,state:s,postcode:p,city:d,address:u,address_2:m,s_country:h,s_state:_,s_postcode:y,s_city:f,s_address:g,s_address_2:v,has_full_address:w,post_data:e("form.checkout").serialize()};if(!1!==o.update_shipping_method){var F={};e('select.shipping_method, input[name^="shipping_method"][type="radio"]:checked, input[name^="shipping_method"][type="hidden"]').each(function(){F[e(this).data("index")]=e(this).val()}),b.shipping_method=F}e(".woocommerce-checkout-payment, .woocommerce-checkout-review-order-table").block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),l.xhr=e.ajax({type:"POST",url:wc_checkout_params.wc_ajax_url.toString().replace("%%endpoint%%","update_order_review"),data:b,success:function(o){if(o&&!0===o.reload)return void window.location.reload();e(".woocommerce-NoticeGroup-updateOrderReview").remove();var r=e("#terms").prop("checked"),s={};if(e(".payment_box :input").each(function(){var t=e(this).attr("id");t&&(-1!==e.inArray(e(this).attr("type"),["checkbox","radio"])?s[t]=e(this).prop("checked"):s[t]=e(this).val())}),payplus_script_checkout.isHostedFields&&0===c.length&&payplus_script_checkout.hidePPGateway){const e=function(e,t){const o=document.createElement("div");o.innerHTML=e;o.querySelectorAll(`.${t}`).forEach(e=>{e.remove()});return o.innerHTML}(o.fragments[".woocommerce-checkout-payment"],"wc_payment_method.payment_method_payplus-payment-gateway");o.fragments[".woocommerce-checkout-payment"]=e}e(".hostedFields").prop("outerHTML");o&&o.fragments&&(e.each(o.fragments,function(t,o){if(!l.fragments||l.fragments[t]!==o){e(t).replaceWith(o),payplus_script_checkout.isSubscriptionOrder&&e(".wc_payment_methods.payment_methods.methods .wc_payment_method").each(function(){e(this).attr("class").split(/\s+/).forEach(function(t){payplus_script_checkout.isLoggedIn?t.startsWith("payment_method_payplus-payment-gateway-")&&"payment_method_payplus-payment-gateway-hostedfields"!==t&&e(this).remove():t.startsWith("payment_method_payplus-payment-gateway-")&&e(this).remove()}.bind(this))}),document.querySelector("#payplus-checkout-image-div")||function(){if(void 0!==payplus_script_checkout?.customIcons[0]&&payplus_script_checkout?.customIcons[0]?.length>0){var t=e("<div></div>",{class:"payplus-checkout-image-container",id:"payplus-checkout-image-div",style:"display: flex;flex-wrap: wrap;justify-content: center;"});e.each(payplus_script_checkout.customIcons,function(o,a){var i=e("<img>",{src:a,class:"payplus-checkout-image",alt:"Image "+(o+1),style:"max-width: 100%; max-height:35px;object-fit: contain;"});t.append(i)}),e("div.payment_method_payplus-payment-gateway").prepend(t)}}();!function(){const e=document.querySelector("#payment_method_payplus-payment-gateway-multipass");if(e&&Object.keys(payplus_script_checkout.multiPassIcons).length>0){const i=payplus_script_checkout.multiPassIcons;function t(e){let t=document.querySelectorAll("img");for(let o of t)if(o.src.includes(e))return o;return null}function o(e,t){e&&t&&(e.style.height="32px",e.style.width="32px",e.style.transition="opacity 0.5s",e.style.opacity=0,setTimeout(()=>{e.src=t,e.style.opacity=1},500))}if(e){let n=t("multipassLogo.png");if(n){n.src;let c=0;const r=Object.keys(i).map(e=>i[e]);function a(){const e=r[c];o(n,e),c=(c+1)%r.length,Object.keys(payplus_script_checkout.multiPassIcons).length>1&&setTimeout(a,2e3)}a()}}}}()}e(t).unblock(),"undefined"!=typeof newPpShippingMethods&&createNewShippingMethods()}),payplus_script_checkout.isHostedFields&&h(a,t),l.fragments=o.fragments,"pp_iframe_h"===i.parent().attr("class")&&function(){if(payplus_script_checkout.isHostedFields){if(!(jQuery(".pp_iframe").length>0||jQuery(".pp_iframe_h").length>0))return jQuery(".payment_method_payplus-payment-gateway-hostedfields").hide(),void(jQuery("input#payment_method_payplus-payment-gateway-hostedfields").is(":checked")&&jQuery("input#payment_method_payplus-payment-gateway").prop("checked",!0).trigger("change"));if(n){n=!1;var o=e('<p class="hf-save form-row"><label for="save_token_checkbox"><input type="checkbox" name="wc-save-token" id="save_token_checkbox" value="1" style="margin:0 10px 0 10px;"/> '+payplus_script_checkout.saveCreditCard+"</label></p>");payplus_script_checkout.isLoggedIn&&payplus_script_checkout.isSavingCerditCards&&i.append(o),t?setTimeout(function(){e("input#"+a).trigger("click"),e("div.container.hostedFields").show()},1e3):setTimeout(function(){e(".payment_method_payplus-payment-gateway").css("display","block"),e("input#"+a).removeAttr("checked"),e(".container.hostedFields").hide(),e(".payment_box.payment_method_payplus-payment-gateway-hostedfields").hide(),e("input#payment_method_payplus-payment-gateway").prop("checked",!0)},1e3)}e(document).on("change",'input[name="payment_method"]',function(){e("input#"+a).is(":checked")?e("div.container.hostedFields").show():e(".container.hostedFields").hide()})}}());let p=!1;if(p)return;p=!0;var d=e('input[name="shipping_method[0]"]:checked').closest("li").find("label").text();""===d&&(d=e('input[name="shipping_method[0]"]').closest("li").find("label").text());var u=d.match(/(\$|₪)\s*([0-9.,]+)|([0-9.,]+)\s*(\$|₪)/);let m=0;if(u){u[1]||u[4];m=u[2]||u[3]}function h(t,o){o&&(e(".woocommerce-SavedPaymentMethods-new").hide(),e(".woocommerce-SavedPaymentMethods-saveNew").hide()),setTimeout(function(){if(e("input#payment_method_payplus-payment-gateway-hostedfields").is(":checked")){e(".container.hostedFields").show();const t=document.querySelector(".pp_iframe_h");t&&(t.style.display="block")}},2e3);var a=jQuery("#"+t),n=jQuery(".pp_iframe_h"),c=jQuery(".wc_payment_method."+t);let r=i.find(".hf-main").first();a.length&&n.length&&i.length&&(payplus_script_checkout.hostedFieldsWidth&&r.attr("style",function(e,t){return"width: "+payplus_script_checkout.hostedFieldsWidth+"% !important;"+(t?" "+t:"")}),n.append(i),c.append(n))}if(payplus_script_checkout.isHostedFields&&e(document.body).on("updated_checkout",function(){h(a,t)}),r&&e("#terms").prop("checked",!0),e.isEmptyObject(s)||e(".payment_box :input").each(function(){var t=e(this).attr("id");t&&(-1!==e.inArray(e(this).attr("type"),["checkbox","radio"])?e(this).prop("checked",s[t]).trigger("change"):(-1!==e.inArray(e(this).attr("type"),["select"])||null!==e(this).val()&&0===e(this).val().length)&&e(this).val(s[t]).trigger("change"))}),o&&"failure"===o.result){var _=e("form.checkout");e(".woocommerce-error, .woocommerce-message").remove(),o.messages?_.prepend('<div class="woocommerce-NoticeGroup woocommerce-NoticeGroup-updateOrderReview">'+o.messages+"</div>"):_.prepend(o),_.find(".input-text, select, input:checkbox").trigger("validate").trigger("blur"),l.scroll_to_notices()}l.init_payment_methods(),e(document.body).trigger("updated_checkout",[o])}})}},handleUnloadEvent:function(e){if(-1===navigator.userAgent.indexOf("MSIE")&&!document.documentMode)return!0;e.preventDefault()},attachUnloadEventsOnSubmit:function(){e(window).on("beforeunload",this.handleUnloadEvent)},detachUnloadEventsOnSubmit:function(){e(window).off("beforeunload",this.handleUnloadEvent)},blockOnSubmit:function(t){1!==t.data("blockUI.isBlocked")&&(t.block({message:null,overlayCSS:{top:0,height:"100%",background:"#fff",opacity:.6}}),e(".blockUI.blockOverlay").css("position","fixed"))},submitOrder:function(){l.blockOnSubmit(e(this))},submit:function(){l.reset_update_checkout_timer();var t=e(this);return t.is(".processing")||!1!==t.triggerHandler("checkout_place_order")&&!1!==t.triggerHandler("checkout_place_order_"+l.get_payment_method())&&(t.addClass("processing"),l.blockOnSubmit(t),l.attachUnloadEventsOnSubmit(),e.ajaxSetup({dataFilter:function(e,t){if("json"!==t)return e;if(l.is_valid_json(e))return e;var o=e.match(/{"result.*}/);return null===o||l.is_valid_json(o[0])&&(e=o[0]),e}}),e.ajax({type:"POST",url:wc_checkout_params.checkout_url,data:t.serialize(),dataType:"json",success:function(o){if("hostedFields"===o.method)jQuery.ajax({type:"post",dataType:"json",url:payplus_script_checkout.ajax_url,data:{action:"get-hosted-payload",_ajax_nonce:payplus_script_checkout.frontNonce},success:function(e){const t=JSON.parse(e.data.hostedPayload);JSON.parse(e.data.hostedResponse);t.more_info&&!isNaN(t.more_info)&&"number"==typeof t.more_info?(overlay(),jQuery(".blocks-payplus_loader_hosted").fadeIn(),l.$checkout_form.removeClass("processing").unblock(),hf.SubmitPayment()):(window.onbeforeunload=null,window.removeEventListener("beforeunload",l.detachUnloadEventsOnSubmit()),alert("The payment page has expired, refresh the page to continue"),location.reload())}});else{if(l.detachUnloadEventsOnSubmit(),o.payplus_iframe&&"success"===o.result)return l.$checkout_form.removeClass("processing").unblock(),"samePageIframe"==o.viewMode?function(t){e(".alertify").remove();const o=new URL(window.location.href);o.searchParams.set("payplus-iframe","1"),window.history.pushState({},"",o);const a=document.querySelector(".pp_iframe"),i=a.getAttribute("data-height");a.innerHTML="",a.append(w(t,"100%",i)),e("#closeFrame").on("click",function(e){e.preventDefault(),a.style.display="none"}),e("#place_order").prop("disabled",!0),payplus_script_checkout.payplus_mobile&&e("html, body").animate({scrollTop:e(".place-order").offset().top});k()}(o.payplus_iframe.data.payment_page_link):"popupIframe"==o.viewMode&&function(e,t){let o=window.innerWidth;o<568&&(t="100%");alertify.popupIframePaymentPage||alertify.dialog("popupIframePaymentPage",function(){return{main:function(e){this.message=w(e,"100%",t),k()},setup:function(){return{options:{autoReset:!1,overflow:!1,maximizable:!1,movable:!1,frameless:!0,transition:"fade"},focus:{element:0}}},prepare:function(){this.setContent(this.message)},hooks:{onshow:function(){this.elements.dialog.style.maxWidth="100%",this.elements.dialog.style.width=o>768?payplus_script_checkout.iframeWidth||"40%":"98%",this.elements.dialog.style.height=o>568?"82%":"100%",this.elements.content.style.top="25px"}}}});alertify.popupIframePaymentPage(e)}(o.payplus_iframe.data.payment_page_link,700),u(o),!0;"iframe"===o.viewMode&&"success"===o.result&&o.order_id&&o.order_received_url&&u(o);try{if("success"!==o.result||!1===t.triggerHandler("checkout_place_order_success",o))throw"failure"===o.result?"Result failure":"Invalid response";-1===o.redirect.indexOf("https://")||-1===o.redirect.indexOf("http://")?d(o.redirect):d(decodeURI(o.redirect))}catch(t){if(!0===o.reload)return void window.location.reload();!0===o.refresh&&e(document.body).trigger("update_checkout"),o.messages?l.submit_error(o.messages):l.submit_error('<div class="woocommerce-error">'+wc_checkout_params.i18n_checkout_error+"</div>")}}},error:function(e,t,o){l.detachUnloadEventsOnSubmit(),l.submit_error('<div class="woocommerce-error">'+o+"</div>")}})),!1},submit_error:function(t){e(".woocommerce-NoticeGroup-checkout, .woocommerce-error, .woocommerce-message").remove(),l.$checkout_form.prepend('<div class="woocommerce-NoticeGroup woocommerce-NoticeGroup-checkout">'+t+"</div>"),l.$checkout_form.removeClass("processing").unblock(),l.$checkout_form.find(".input-text, select, input:checkbox").trigger("validate").trigger("blur"),l.scroll_to_notices(),e(document.body).trigger("checkout_error",[t])},scroll_to_notices:function(){var t=e(".woocommerce-NoticeGroup-updateOrderReview, .woocommerce-NoticeGroup-checkout");t.length||(t=e(".form.checkout")),e.scroll_to_notices(t)}},m={init:function(){e(document.body).on("click","a.showcoupon",this.show_coupon_form),e(document.body).on("click",".woocommerce-remove-coupon",this.remove_coupon),e("form.checkout_coupon").hide().on("submit",this.submit)},show_coupon_form:function(){return e(".checkout_coupon").slideToggle(400,function(){e(".checkout_coupon").find(":input:eq(0)").trigger("focus")}),!1},submit:function(){var t=e(this);if(t.is(".processing"))return!1;t.addClass("processing").block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var o={security:wc_checkout_params.apply_coupon_nonce,coupon_code:t.find('input[name="coupon_code"]').val()};return e.ajax({type:"POST",url:wc_checkout_params.wc_ajax_url.toString().replace("%%endpoint%%","apply_coupon"),data:o,success:function(a){e(".woocommerce-error, .woocommerce-message").remove(),t.removeClass("processing").unblock(),a&&(t.before(a),t.slideUp(),e(document.body).trigger("applied_coupon_in_checkout",[o.coupon_code]),e(document.body).trigger("update_checkout",{update_shipping_method:!1}))},dataType:"html"}),!1},remove_coupon:function(t){t.preventDefault();var o=e(this).parents(".woocommerce-checkout-review-order"),a=e(this).data("coupon");o.addClass("processing").block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var i={security:wc_checkout_params.remove_coupon_nonce,coupon:a};e.ajax({type:"POST",url:wc_checkout_params.wc_ajax_url.toString().replace("%%endpoint%%","remove_coupon"),data:i,success:function(t){e(".woocommerce-error, .woocommerce-message").remove(),o.removeClass("processing").unblock(),t&&(e("form.woocommerce-checkout").before(t),e(document.body).trigger("removed_coupon_in_checkout",[i.coupon_code]),e(document.body).trigger("update_checkout",{update_shipping_method:!1}),e("form.checkout_coupon").find('input[name="coupon_code"]').val(""))},error:function(){},dataType:"html"})}},h={init:function(){e(document.body).on("click","a.showlogin",this.show_login_form)},show_login_form:function(){return e("form.login, form.woocommerce-form--login").slideToggle(),!1}},_={init:function(){e(document.body).on("click","a.woocommerce-terms-and-conditions-link",this.toggle_terms)},toggle_terms:function(){if(e(".woocommerce-terms-and-conditions").length)return e(".woocommerce-terms-and-conditions").slideToggle(function(){var t=e(".woocommerce-terms-and-conditions-link");e(".woocommerce-terms-and-conditions").is(":visible")?(t.addClass("woocommerce-terms-and-conditions-link--open"),t.removeClass("woocommerce-terms-and-conditions-link--closed")):(t.removeClass("woocommerce-terms-and-conditions-link--open"),t.addClass("woocommerce-terms-and-conditions-link--closed"))}),!1}};if(l.init(),m.init(),h.init(),_.init(),e(document.body).on("updated_checkout",function(){var t=e('input[name="payment_method"]:checked');if(t.length){var o=t.attr("id");o&&l.selectedPaymentMethod!==o&&(l.selectedPaymentMethod=o)}}),payplus_script_checkout.hostedFieldsIsMain){var y=function(){e("li.payment_method_payplus-payment-gateway").attr("style","display: none !important;")};function f(){var t=e("input#payment_method_payplus-payment-gateway-hostedfields");t.length&&(t.is(":checked")||t.prop("checked",!0).trigger("change"),e(".payment_box.payment_method_payplus-payment-gateway-hostedfields").show().css("display","block"))}y(),e(document.body).on("updated_checkout",function(){y(),f()}),setTimeout(function(){y(),f()},100)}if(e(document.body).on("change",'input[name="payment_method"]',function(){"payplus-payment-gateway-hostedfields"===e('input[name="payment_method"]:checked').val()&&e(".payment_box.payment_method_payplus-payment-gateway-hostedfields").show()}),e(document.body).on("click","#place_order",function(t){var o=e('input[name="wc-payplus-payment-gateway-payment-token"]:checked').val(),a=e("input#payment_method_payplus-payment-gateway-hostedfields"),i=e("input#payment_method_payplus-payment-gateway");if(a.is(":checked")&&o&&"new"!==o){if(0===i.length)return alert("Error: Payment method not available for saved cards. Please contact support."),t.preventDefault(),!1;i.prop("checked",!0),a.prop("checked",!1)}}),e(document.body).on("change",'input[name="wc-payplus-payment-gateway-payment-token"]',function(){var t=e(this).val(),o=e("input#payment_method_payplus-payment-gateway-hostedfields"),a=e(".payment_method_payplus-payment-gateway"),i=e("input#payment_method_payplus-payment-gateway");if(o.is(":checked"))if("new"!==t){if(0===a.length){e(".payment_method_payplus-payment-gateway-hostedfields").before('<li class="wc_payment_method payment_method_payplus-payment-gateway" style="display:none !important;"><input id="payment_method_payplus-payment-gateway" type="radio" class="input-radio" name="payment_method" value="payplus-payment-gateway" /><label for="payment_method_payplus-payment-gateway">PayPlus</label><div class="payment_box payment_method_payplus-payment-gateway"></div></li>'),i=e("input#payment_method_payplus-payment-gateway")}i.prop("checked",!0),e("body").attr("data-payplus-using-token","yes")}else o.prop("checked",!0),e("body").attr("data-payplus-using-token","no")}),e(document.body).on("click touchstart",".pp_iframe_h, .pp_iframe_h *",function(t){e("input#payment_method_payplus-payment-gateway-hostedfields").is(":checked")&&(e('input[name="wc-payplus-payment-gateway-payment-token"]:checked').prop("checked",!1),e("input#wc-payplus-payment-gateway-payment-token-new").prop("checked",!0).trigger("change"))}),payplus_script_checkout.hostedFieldsIsMain)setInterval(function(){var t=e(document.activeElement);if(t.is("iframe")&&t.closest(".pp_iframe_h").length&&e("input#payment_method_payplus-payment-gateway-hostedfields").is(":checked")){var o=e('input[name="wc-payplus-payment-gateway-payment-token"]:checked');o.length&&"new"!==o.val()&&(o.prop("checked",!1),e("input#wc-payplus-payment-gateway-payment-token-new").prop("checked",!0).trigger("change"))}},300);function g(t){e("#pp_iframe").length&&(e("#pp_iframe").is(":visible")||!0===t)&&e("#pp_iframe").fadeOut(()=>{e(".payplus-option-description-area").show(),e("#place_order").prop("disabled",!1)})}e(document.body).on("click touchstart",".pp_iframe_h",function(t){var o=e(this).closest("li.wc_payment_method");if(o.length){var a=o.find('input[name="payment_method"]');a.length&&!a.is(":checked")&&a.prop("checked",!0).trigger("click")}}),e(e(window).on("popstate",()=>{g(!1)}));let v=!1;function k(){if(v)console.log("Apple script already loaded");else{const e=document.createElement("script");e.src=payplus_script_checkout.payplus_import_applepay_script,document.body.append(e),v=!0}}function w(e,t,a){let i=document.createElement("iframe");return i.id="pp_iframe",i.name="payplus-iframe",i.src=e,o?(i.height="100%",i.maxHeight="100vh"):i.height=a,i.width=t,i.setAttribute("style","border:0px"),i.setAttribute("allowpaymentrequest","allowpaymentrequest"),i.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups allow-top-navigation"),i}});